#Navegando pelo sistema de arquivo
pwd    #mostra aonde você está
cd /    #muda para a pasta raíz do seu disco, só use o barra se arquivo estiver na raiz, caso contrário use sem cd log
./     #indica onde você está
ls      #mostra os arquivos do diretório (cor azul)
cd /var   # muda para o diretório var, se você estiver no diretório, pode usar o cd var
cd ..     #volta para o diretório anterior
cd ../backups   #volta e vai para o diretório backups
cd /var/lib    #abre o lib dentro do var
cd /var/lib/git   #vai para o git passando pelos diretórios raiz,var e lib

#O tab duas vezes mostra os comandos que você pode usar ou preenche na tela
ls | more    #abre a opção de ver todos os arquivos que não cabe na tela toda, aperte enter caso apareça more, para sair use o ctrl c
ls nome do arquivo    #lista o arquivo com esse nome
touch arquivo.txt   #Criar um arquivo vazio se for criar em um diretório do sistema como /etc é necessário usar o sudo. 
#Pode criar arquivo no diretório home, onde fica os usuários
cd ~    #vai para o diretório home
touch arquivo2.txt arquivo3.txt arquivo4.txt #cria vários arquivos
cat nome do arquivo   #visualizar o arquivo

#Localiza arquivos
ls /sys   #lista os arquivos contidos no diretório sys ls /~
ls /sys/kernel   #lista os arquivos que estão no kernel que está dentro do sys
ls /sys/kernel/p*  #lista os arquivos que começam com p que está dentro do kernel,que está dentro sys, ou seja de forma recursiva.
find / -name  arq*    #busca o arquivo onde você está pelo nome ou pelo filtro de pesquisa que você indicar
locate nomedoarquivo  #talvez seja necessário instalar  
ls -R /etc/   #lista os arquivos de forma recursiva informando seu conteúdo ls -r
tree 
which git  #mostra o caminho do arquivo
du ?  # 

#Criando e excluindo usuários
#Para esses comandos é necessário está como usuário root ou use o sudo
getent passwd  #Obtém a lista de contas de usuário no sistema
useradd joao.silva     #cria o usuário joao.silva, não deixe espaço nem use acento para evitar conflitos
userdel -f joao.silva   #exclui o usuário
useradd joao -m -c “ joão da Silva”   #cria o usuário com uma pasta no home com descrição do seu nome todo. O usuário criado terá como linha 
#de comando o shell, e não o bash. Para alterar será necessário usar o comando chsh com seus respectivos parâmetros
passwd joao   #comando para definir ou redefinir a senha do joao,
chsh -- -s /bin/bash joao     #habilita o bash  para o joao ao invés do shell
userdel -r -f joao   #apagar tudo referente ao joao, pastas emails
useradd joao -m -c “ joão da Silva” -s /bin/bash  #cria o usuário com uma pasta no home com descrição do seu nome todo e com o shell 
useradd joao -c  “ joão da Silva” -s /bin/bash -m -p $(openssl passwd -crypt senha123) #cria o usuário com uma descrição,com o bash, 
#pasta no diretório home e exigência de senha encriptada, neste caso a senha encriptada é o 123. Comando que realmente funcionou 
useradd convidado1 -c "Convidado" -s /bin/bash -m -p $(openssl passwd senha123)

#Editando informações do usuário
useradd maria -c “Convidado” -m -e 26/06/2022  #Esse usuário só acessa o sistema até essa data, você terá que atribuir
#uma senha para esse usuário caso o sistema solicite.
usermod guest -s /bin/bash  #modifica as configurações do usuário criado anteriormente
passwd guest -e  #exigirá a mudança de senha quando o usuário logar
cat /etc/passwd   #informações dos usuários criado

#Adicionando usuário a grupos
usermod -aG adm,sudo mariana   #adiciona a mariana no grupo adm e grupo sudo sem remover os grupos existentes, talvez seja necessário
#logar novamente para as configurações ativar nas conta, 
cat /etc/group  #comando para visualizar os grupos

#Criar grupos
groupadd DDD_ADM     #cria grupo com o nome DDD_ADM
groupdel DDD_ADM     #exclui o grupo, se estiver com usuário não será possível, tem que excluir o usuário primeiro.
useradd joao -c  “ joão da Silva” -s /bin/bash -m -p $(openssl passwd -crypt senha123) -G DDD_ADM  #cria o usuário com uma descrição,
#com o bash, pasta no diretório home, exigência de senha encriptada, neste caso a senha encriptada é o 123, e o adiciona no grupo DDD_adm
usermod -G DDD_ADM mariana   #remove mariana do grupo que ela estiver e coloca no grupo DDD_ADM, para manter ela em outros grupos 
#use a vírgula e o nome do grupo desejado.
gpasswd -d mariana sudo   #remove do usuário sudo

#Sistema de Permissões
#No diretório home com o comando ls -l mostra os usuários e suas permissões
#as letras representam: D(DIRETÓRIO) - (ARQUIVOS) RWX(DONO) RWX(GRUPO) RWX(OUTROS) 
chown mariana:DDD_ADM /adm   #habilitar a usuária mariana para ler, gravar e executar, ela passa a ser proprietária.
chown mariana:DDD_ADM /ven  #permite a mariana a ser dona do grupo DDD_ADM  e o  diretório  ven


#Alterando as permissões de arquivos
#Base numérica para permissão de arquivos , R4 W2 X1. 7 equivale a permissão total, 0 permissão nenhuma, 
#1 execução, 3 leitura e gravação, 5 execução e leitura
chmod 750 /adm/  #o dono terá permissão total, o grupo terá permissão de execução e leitura, outros permissões nenhuma no diretório adm
chmod 775 /ven   #dono permissão total, grupo permissão total, outros leitura e execução
chown root:GRP_ADM texto-adm.txt    #muda as permissões de um arquivo e específico, faça no modo superusuário
chmod 750 texto-adm.txt   #permissão específica rwx rx-  ---
chmod 777 /publica   #permissão total para todos para o diretório publica 

#Permissão de execução
#Mesmo como root arquivos de execução (.sh) necessita de alteração de execução arquivo date.sh
chmod 744 date.sh   #habilita o root para permissão total e grupo e outros para leitura arquivo date.sh
chmod 644 date.sh  #habilita leitura e gravação para o root e leitura para grupos e outros arquivo date.sh
chmod +x date.sh   #habilita a execução para o dono arquivo date.sh
chmod -x date.sh  #remove a permissão de execução do root para o arquivo date.sh


#Criando diretório
mkdir /Documentos   #criar um diretório a partir da raiz  é necessário ter permissão.
mkdir Documentos    #criar um diretório 
touch arquivo.txt   #Criar um arquivo vazio
mkdir /home/jose/excel/contas   #cria o diretório contas de forma recursiva 
mkdir ‘Meus documentos’  #cria um diretório aceitando espaço, se não colocar aspas ele criará a pasta Meus e pasta Documentos


#Excluindo arquivos e diretórios
rmdir pasta3.txt    #exclui o diretório pasta3.txt, se for um diretório com conteúdo ele não deixa excluir será necessário limpar a pasta. 
#Também não é possível apagar um diretório se você estiver dentro dele, é necessário sair.
rm arquivo2.txt     #exclui o arquivo arquivo2.txt
rm arquivo*     #apagar todos arquivos com esse nome
rmdir Alunos Professores    #apaga os 2 diretórios de uma só vez
rmdir ‘Meus Documentos’    #apagar o diretório Meus Documentos
rm -rf  Planilhas/    #apagar de forma recursiva tudo dentro de do diretório Planilhas e tudo que há dentro delas 
rm -rfv   #força para excluir e sinaliza o que está acontecendo 
rm -rfvi  #força para excluir e sinaliza o que está acontecendo para você concordar ou não
mv -i  #renomeia informando, muito cuidado com esse comando

#Obtendo ajuda
ls --help    #descreve as opções do ls
man ls   #descreve o que faz o comando ls  (em inglês) aperte q para sair
ls -l   #lista de comprimento longo, as informações iniciadas com - são arquivos, d diretórios, l links que redirecionam para outro local, 
#rwx representam permissões, 4 quantidades de objetos (arquivos ou diretórios). root root representa o dono e grupo, 4096 representa o tamanho em kb, 
#para um formato mais compreensível use o ls -lh
ls -a  #mostra todos os objetos incluindo os ocultos pode usar também o ls -lah

#Histórico de comandos
history   #mostra os últimos comandos realizados até 1000 comandos
history 10  #mostra os 10 últimos comandos, o comando listado no history pode ser utilizado se você usar !21, será dado 
#o comando que aparece na lista 21 do history
!!   #usa o último comando digitado 
!?sys?    #executa o comando que foi usado recentemente que se inicia com sys
history | grep  “Planilhas”  #mostra a ordem com o que comando foi digitado sem executar
export HISTTIMEFORMAT=”%c ”  #habilitar o history para dar informações completa de quando o comando que você quer foi utilizado
history -c   #apagar o histórico de comandos
set +o history    #comando para que o histórico não seja mais armazenado
set -o history    #comando para que volte a armazenar os comando no histórico

#Executando tarefas administrativa como root
cat /etc/group     #para visualizar os grupos
sudo    #invoca a permissão de superusuário
sudo cat /etc/sudoers  #arquivo de configuração que mostra os privilégios dos usuários
tail -f /var/log/syslog    #comando para visualizar erros
shutdown 0  # desliga no mesmo instante
sudo apt-get install openssh-server  #instala o programa
sudo systemctl status ssh  #saber se o ssh está operante 
sudo ufw status    #saber se o firewall está operante
sudo ufw allow ssh   #liberar o ssh no firewall
ip a         #mostra o ip
ssh user@ip    #acessar o servidor
sudo systemctl disable --now ssh  #desativa o ssh no mesmo instante sem precisar reiniciar
sudo systemctl enable --now ssh  #ativa o ssh no mesmo instante sem precisar reiniciar
sudo chmod 600 arquivo.pem     #para proteger o arquivo .pem
date   #mostra a data
sudo /bin/sh /xxxxxx/script/monitor.sh enable #xxx equivale para o nome so sistema, esse comando habilita a interface gráfica,
# em servidor oracle linux

#Não é recomendado ficar logado como root, faça as configurações necessárias e depois use o usuário convencional.

sudo passwd root   #concede a senha de superusuário para o usuário root, pedirá a senha que foi definida no momento da instalação. 
#Agora defina uma senha para esse usuário
su  #muda para superusuário em que não será necessário digitar sudo  
su luiz  #muda para o usuário luiz
poweroff   #desliga
reboot     #reinicia 

#É possível logar pelo Putty como root, porém essa configuração deve está liberada no ubuntu server

#liberando o acesso remoto do usuário root
cat /etc/ssh/sshd_config   #mostra o arquivo de configuração de acesso remoto 
sudo nano /etc/ssh/sshd_config  #abre o arquivo em um editor de texto para poder configurá lo para o acesso remoto será necessário 
#alterar o #PermitRootLogin prohibit-password para PermitRootLogin yes. ctrl o (salvar, enter para continuar com o mesmo nome) 
#ctrl x  para sai 
systemctl status sshd  #mostra o status do sshd ctrl c para sair talvez 2 vezes
systemctl restart sshd    #reinicia o serviço sshd e agora o acesso remoto estará liberado

#Trabalhando com editores de arquivo
vi leiame.txt     #se existir ele abre o arquivo, se não, ele cria e abre no editor vi (new file). 
#Dentro do vi siga essas dicas pressione i modo de edição (insert). faça as alterações ou digite, quando finalizar sua tarefa 
#pressione esc para sair do modo de inserção, para ativar o menu pressione : para sair salvando digite wq e enter . 
#pronto seu texto está salvo.
cat nome do arquivo   #visualizar o arquivo

nano leiame.txt     #se existir, ele abre o arquivo, se não, ele cria e abre no editor nano, o nano já têm explicação do seu uso 
#na parte inferior do editor o acento chapéu ^ é o ctrl. ctrl o (salvar, enter para continuar com o mesmo nome)  ctrl x  para sai. 
#lembre-se de indicar o caminho, para que o arquivo salvo não vá para outro local

#Shell Script Criando usuários em lote.Tarefa para ser usado de forma automática 
cd /   #vai para a raíz
mkdir /scripts     #cria uma pasta com o nome scripts
cd /scripts      #muda para pasta scripts
nano criar_user.sh    #abre o nano com o arquivo criar_user.sh

#Dentro do nano criaremos o script
#!/bin/bash          #indica que é um script em bin
echo “Criando usuário do sistema….”   #exibir mensagem na tela
useradd guest10 -c “Usuário experimental” -s /bin/bash -m -p $(open passpwd -crypt Senha123)  #cria o usuário com o nome guest10 uma descrição Usuário experimental,
#com o bash, pasta no diretório home e exigência de senha encriptada, neste caso a senha encriptada é o 123.Comando que realmente funcionou foi esse abaixo
useradd guest10 -c "Usuário experimental" -s /bin/bash -m echo "guest10:$(openssl passwd -crypt Senha123)"
passwd guest -e   #força o usuário a trocar a senha
echo “Finalizado!!”  #exibe a mensagem na tela

#Aperte ctrl o para salvar e ctrl x para sair. No sistema a ser utilizado será necessário habilitar permissão de execução para esse arquivo.
#no diretório scripts ou onde for inserido esse arquivo chmod +x criar_user.sh    #permissão para executar o arquivo  criar_user.sh no bash ele irá mudar de cor.
./criar_user.sh  #executar esse arquivo
cat /etc/passwd   #mostra os usuário criados.Tente logar pelo putty com os usuários criados para validar se deu certo.

#Formato para uso do script, se necessário copie e cole alterando o nome e senha para mais usuários
#!/bin/bash

echo “Criando usuário do sistema….”
useradd guest10 -c “Usuário experimental” -s /bin/bash -m -p $(open passpwd -crypt Senha123)
passwd guest -e
useradd guest11 -c “Usuário experimental” -s /bin/bash -m -p $(open passpwd -crypt Senha234)
passwd guest -e
useradd guest12 -c “Usuário experimental” -s /bin/bash -m -p $(open passpwd -crypt Senha345)
passwd guest -e
echo “Finalizado!!”
#Talvez seja necessário remover o menos -p para dar certo

#Gerenciamento de pacotes (Ubuntu-Debian)
apt-get  #ideal para script, não tem muitas interrupções, também não dá muitas informações apt-get --help  #informa os parâmetros a ser usado
apt-get update  #atualiza a lista de pacotes da distribuição que você está usando
apt-get upgrade  #atualiza os pacotes instalados
apt-get install  #instala pacotes ou programas
apt-get reinstall   #reinstala o programa
apt-get remove  #remove 
apt-get autoremove   #remove automaticamente todos os pacotes não utilizados
apt-get purge   remove os pacotes e ficheiros de configuração

 Há também o apt mais atual e amigável, use o apt --help para ver as variações de comandos 

apt list   #lista os pacotes baseados no nomes
apt-search   #  busca o pacote
apt-install     #instala
apto install  # reinstala
apt-remove    #remove
apt-show     #mostra os detalhes do pacote
apt-autoremove  #remove automaticamente todos os pacotes não utilizados
apt-update    #atualiza a lista de pacotes
apt-upgrade  #atualiza os pacotes
apt full-upgrade  #atualiza o sistema, os pacotes e remove serviço completo

apt list --installed   #mostra o que tem instalado na máquina
apt list --upgradable   #mostra o pacote que pode ser atualizado
apt search samba  #exibe resultados referente ao samba versões, funções 

wget (url……)   # baixa o conteúdo da url para o diretório em que você estiver
apt install unzip    #instala o descompactador  unzip 
unzip main.zip   #descompactar o arquivo main.zip
apt remove unrar  #desinstalar o descompactador unrar
apt remove unrar -y #desinstalar sem perguntar, ideal para o uso em script
apt edit-sources  #mostrar uma lista de todos os repositório oficiais do ubuntu, quando você precisar de um repositório externo 
#cole o link dele dentro desse arquivo de listas e salve

#Atualização do sistema operacional
#Para evitar problemas, faça um screenshot, antes de atualizar o sistema em virtualizadores,
apt-update    #atualiza a lista de pacotes
apt-upgrade  #atualiza os pacotes
#Faça os testes caso algum programa não funcione da forma devida, desligue o pc shutdown 0 e volte 
#para o estado antes da atualização rollback. Esse prática é muito comum nos provedores de nuvem.

#Gerenciamento de pacotes Fedora, Red Hat e Centos

#O comando dnf é similar ao apt moderno e amigável, e o yum similar ao apt-get mais antigo menos amigável 
#ideal para script. Use  help para saber sobre os parâmetros yum --help, dnf --help 

dnf install  #instala
dnf remove   #remove  
yum install  #instala     
yum remove   #remove
dnf update   # já baixa e instala não há o upgrade 
yum update   # já baixa e instala não há o upgrade

#Instalação de arquivo debian
#.db extensão de arquivo Debian Ubuntu   .rpm extensão para Red Hat, Fedora e Suse
apt install ./google-chrome stable_current_amd64.deb  #irá instalar o arquivo ./google-chrome stable_current_amd64.deb
dnf install ./google-chrome stable_current_amd64.rpm  #irá instalar o arquivo ./google-chrome stable_current_amd64.rpm











