# Criando máquina virtual na Azure, Home, Virtual machine, preencha os campos, modalidade gratuita.
# Escolha a imagem Ubuntu Server 24.04 LTS -64 Gen2 (não escolha o ARM64), libere as portas 80,22 e 443.
# Review + e create

# Usando o WSL, (windows 11) vá no cmd 
  wsl -- list --online
  wsl -- install -d Ubuntu-24.04

#depois de instalado é necessário atualizar.

sudo apt-get update
sudo apt-get upgrade -y

#instalar o docker no ubuntu siga documentaçao official
curl -fsSL https://get.docker.com -o get-docker.sh     # baixar o script de configuração
sudo sh ./get-docker.sh --dry-run   # rodar o script
sudo docker --version   #saber a versão do docker

mkdir App   #cria a pasta App
cd App/    #entra na pasta App
nano index.html     #arquivo da aplicação cole um texto em html para teste e salve (ctrl o , talvez enter, ctrl x) 
ls #para visualizar or arquivo


#para o arquivo rodar é necssário ter ou SO para ouvir as requisições http que poderia ser um servidor apache, nginx e afins.., 
#porém iremos fazer o arquivo rodar encapsulado em um container. Para criar um container é necessário um arquivo de configuração do container 
#com as especificações de aplicação, arquivos que estarão contidos nele
nano dockerfile   #arquivo de configuração do containere

# No arquivo do docker file adicione esses parametros, ou no site oficial da imagem siga as instruções de como usa-la how to use this image
FROM httpd:latest
WORKDIR /usr/local/apache2/htdocs/
COPY . /usr/local/apache2/htdocs/
EXPOSE 80

#salve ctrl o ctrl x, na pasta App de um ls deve aparecer dockerfile  index.html 
sudo docker build -t micro1:1.0 .     #constrói uma imagem apartir do parametros especificados, -t é onde atribui o nome para a imagem. 
#Para ser compartilhado no dockerhub pela internet seria necessário criar um usuário, se o dockerfile estiver em outro diretório seria
# neccessário informar o caminho / no lugar do ponto e o camimho.
# Pressione enter e depois da conclusão da imgem sudo docker images , irá  mostrar a imagem criada, 

sudo docker run -d -p 80:80 --name micro1 micro1:1.0  #startar a imagem -d é para rodar em segundo plano, -p porta, 80 porta do host 80 porta do container, 
# --name atribui nome depois nome e versão(TAG) caso der erro de porta usada, use  
sudo docker ps -l # para lista os docker rodando exclua o docker 
sudo docker ps  #
sudo docker rm xxxx --force   #exclui o docker xxxx de forma forçada  
sudo docker rmi --force  xxxx   #exclui a image do docker
sudo docker images  #saber as images
sudo systemctl status xxxx  #para saber se tem um serviço rodando, na porta 80, exclua a aplicação com esse comando sudo apt-get remove xxxx 
#repita o comando para subir sua aplicação sudo docker run -d -p 80:80 --name micro1 micro1:1.0  teste digitando o ip da sua máquina(servidor)

#Para fazer de forma automatizada pelo GitLab (similar ao GitHub)
#Necessário ter uma conta no GitLab e ele deve se comunicar com a sua aplicação.
#Log na sua conta, New project/repositório, Create blank project (106)




  


  
  
  #Usar um containner (docker hub e afins algumas imagens base estão disponibilizads aqui. oracle, linux, mysql, apache, ...) através dessas 
#imagens é possivel customizar, integrar para fazer funcionar as aplicações,
